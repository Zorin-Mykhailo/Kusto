[🔙](/README.md) Задача **#2313902** от 2023.05.19(Пт) 🚧 В работе
# Изменения в механизме проверки контрагентов СЕБ
💬  
`👤 Веремий Л.`, `👤 Комерч. департамент`  
`🏷️ Контрагенты`, `🏷️ СЕБ`  

---

## Описание задачи

- [ ] Срок действия заключения СЕБ по каждому из контрагентов должен быть не одинаковым для всех контрагентов, а зависеть от `Номенклатурной категории СЕБ`
- [ ] `Номенклатурная категория СЕБ` — Справочник, в котором хранится следующая информация:
	- Название номенклатурной категории
	- Срок истечения заключения СЕБ
- [ ] Предварительно справочник `Номенклатурная категория СЕБ` содержит такие значения:
	
| Название номенклатурной категории | Срок истечения заключения СЕБ |
| --- | ---: |
| Семена | 6 мес |
| СЗР | 6 мес |
| Удобрения | 6 мес |
| Запчасти | 12 мес |
| ГСМ | 4 мес |
| Услуги | 12 мес |

- [ ] C одним контрагентом может быть связано 0, 1 или несколько объектов `Номенклатурная категория СЕБ`
	- [ ] Если записей 0: срок истечения заключения СЕБ берется из глобальной константы (сейчас 4 мес),
	- [ ] Если записей 1 и более срок истечения заключения СЕБ берется по минимальному значению `Срок истечения заключения СЕБ`

- [ ] За 20 дней (по умолчанию, в настройках процесса) инициатору предыдущей проверки СЕБ должно прийти уведомление о скором истечении заключения СЕБ
- [ ] Если инициатор проверки неактевен в ЕЛМА (например уволен) попытаться отправить задачу по повторному заключению СЕБ лицу ответственному за контрагента
- [ ] Поиск сотрудника который может отправлять контрагента на проверку СЕБ можно производить в таблице истории проверок СЕБ по конкретному контрагенту
	- [ ] Реализовать таблицу истории проверок СЕБ. То есть зайдя в контрагента, можно будет увидеть не текущее заключение, а все заключения. Сейчас заключение СЕБ затирается

---

## Дополнительно, на будущее

- [ ] Для справочника `Контрагент` хранить историю проверок СЕБ.
- [ ] Не просто уведомлять ответственного о завершении срока истечения заключения СЕБ, а ставить задачи в процессе повторной проверки.
- [ ] ??? Разработать процесс верификации контрагентов:
	- Ответственная особа должна проверять контрагентов на предмет корректрости заполнения полей `Название`, `ЕДПО`, `Является ли резидентом`, дублирования другого контрагента, и т.п.
	- После проверки выставлять статус `Верифицировано` или `Не прошел верификацию`
	- Затем во всех возможных местах системы использовать только верифицированных контрагентов.